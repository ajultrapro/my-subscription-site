<!DOCTYPE html>
<html>
<head>
    <title>Subscribe to Our Plan</title>
</head>
<body>
    <h1>Our Awesome Plan</h1>
    <p>Please enter your details to sign the agreement and subscribe.</p>

    <form id="userForm">
        <input type="text" id="name" placeholder="Full Name (as per Aadhaar)" required>
        <input type="email" id="email" placeholder="Email Address" required>
        <input type="tel" id="mobile" placeholder="Mobile for Aadhaar OTP" required>
        <button type="submit">Proceed to E-Sign Agreement</button>
    </form>
    <p id="message"></p>

    <script>
        document.getElementById('userForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            document.getElementById('message').innerText = 'Processing... Please wait.';

            const response = await fetch('/.netlify/functions/start-signing', {
                method: 'POST',
                body: JSON.stringify({
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    identifier: document.getElementById('mobile').value
                })
            });

            const data = await response.json();

            if (data.signing_url) {
                window.location.href = data.signing_url;
            } else {
                document.getElementById('message').innerText = 'Error: Could not start signing process.';
            }
        });
    </script>
</body>
</html>